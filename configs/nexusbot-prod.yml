server:
  port: ${SERVER_PORT:5001}
  shutdown: graceful

spring:
  datasource:
    url: jdbc:mysql://${MYSQL_HOST:127.0.0.1}:${MYSQL_PORT:3306}/${MYSQL_DATABASE:nexusbot}?useSSL=false&serverTimezone=Asia/Taipei&characterEncoding=utf8
    driver-class-name: com.mysql.cj.jdbc.Driver
    username: ${MYSQL_USERNAME}
    password: ${MYSQL_PASSWORD}
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false
  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true
  cloud:
    bus:
      enabled: true
  rabbitmq:
    host: ${RABBITMQ_HOST:127.0.0.1}
    port: ${RABBITMQ_PORT:5672}
    username: ${RABBITMQ_USERNAME}
    password: ${RABBITMQ_PASSWORD}

eureka:
  instance:
    prefer-ip-address: true
    ip-address: ${SERVER_HOST:127.0.0.1}
  client:
    service-url:
      defaultZone: http://${EUREKA_SERVER_HOST:127.0.0.1}:${EUREKA_SERVER_PORT:8761}/eureka/

# ==========================================
# 應用程式基礎設定
# ==========================================
nexusbot:
  base-url: ${NEXUSBOT_BASE_URL}

# ==========================================
# LINE Bot
# ==========================================
line:
  bot:
    channel-token: ${LINE_CHANNEL_TOKEN}
    channel-secret: ${LINE_CHANNEL_SECRET}
  liff:
    id: ${LINE_LIFF_ID:}

# ==========================================
# Groq AI
# ==========================================
groq:
  api-key: ${GROQ_API_KEY}

ai:
  conversation:
    history-limit: ${AI_HISTORY_LIMIT:15}

# ==========================================
# Email (SMTP)
# ==========================================
email:
  host: smtp.gmail.com
  port: 587
  username: ${EMAIL_USERNAME}
  password: ${EMAIL_PASSWORD}
  from: ${EMAIL_FROM}
  from-name: ${EMAIL_FROM_NAME:NexusBot 提醒通知}
  auth: true
  starttls: true
  debug: false

# ==========================================
# Fugle API
# ==========================================
fugle:
  api-key: ${FUGLE_API_KEY}
  websocket-url: wss://api.fugle.tw/marketdata/v1.0/stock/streaming
  rest-base-url: https://api.fugle.tw/marketdata/v1.0
  reconnect-delay: 5000
  max-subscriptions: 5

# ==========================================
# FinMind API
# ==========================================
finmind:
  api-token: ${FINMIND_API_TOKEN:}

# ==========================================
# OpenStreetMap API
# ==========================================
osm:
  overpass-base-url: ${OSM_OVERPASS_BASE_URL:https://overpass-api.de/api/interpreter}
  timeout-ms: ${OSM_TIMEOUT:15000}
  user-agent: ${OSM_USER_AGENT:NexusBot/1.0}
  carousel-max-items: ${OSM_CAROUSEL_MAX_ITEMS:10}
  toilet-tags:
    - amenity=toilets          # 公共廁所
    - amenity=public_bookcase  # 部分公共設施含廁所
    - building=toilets         # 廁所建築
  facility-tags:
    - amenity=restaurant       # 餐廳
    - amenity=cafe             # 咖啡廳
    - amenity=fast_food        # 速食店
    - shop=convenience         # 便利商店
    - shop=supermarket         # 超市
    - amenity=fuel             # 加油站

# ==========================================
# 安全設定
# ==========================================
admin:
  password-seed: ${ADMIN_PASSWORD_SEED}

# ==========================================
# 日誌設定
# ==========================================
logging:
  level:
    root: INFO
    com.acenexus.tata.nexusbot: INFO
    com.linecorp.bot.client.wire: WARN
    okhttp3: WARN

# ==========================================
# Actuator
# ==========================================
management:
  endpoints:
    web:
      exposure:
        include: health,busrefresh
      base-path: /actuator
  endpoint:
    health:
      enabled: true
      show-details: when-authorized
